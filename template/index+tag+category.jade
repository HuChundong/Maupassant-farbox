mixin make_posts(posts)
	for post in posts
		article.post
			header
				h2.post-title
					a(href=post.url)= post.title
			date.post-meta= post.date.format('%B %d, %Y')
			section.post-content= post.content.opening or post.content.limit(300)
			if post.tags
				footer
					.tags
						for tag in post.tags
							a(href="/tag/{{tag}}")= tag

if request.args.pjax=='true'
	+make_posts(posts)
else
	extends base
	block title
		title= request.args.s or tags.join('+') or category.title or site.title
	block content
		if request.path.strip('/') == 'category'
			+redirect('/categories')
		if request.path.strip('/') == 'tag'
			+redirect('/tags')

		if tags or category
			h1.archive-title= '正在查看 '+(request.args.s or tags.join('+') or category.title or site.title)+' 下的文章'
		if request.args.s != site.name
			h1.archive-title= '搜索包含 ' + request.args.s + ' 的结果'
		+make_posts(posts)
		include include/paginator

